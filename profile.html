<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JohnBlox - Profile</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Orbitron:700|Roboto:400&display=swap">
    <style>
        body {
            font-family: 'Roboto', Verdana, Arial, sans-serif;
            background: linear-gradient(to right, #d3eafd 0%, #b8c6db 100%);
            margin: 0; color: #2d3748; min-height: 100vh;
        }
        header {
            background: #0074cc;
            color: #fff; padding: 16px 32px;
            display: flex; align-items: center; box-shadow: 0 3px 16px rgba(0,0,0,0.16);
        }
        .logo { height: 48px; margin-right: 20px; cursor: pointer; }
        .site-title { font-family: 'Orbitron', sans-serif; font-size: 2rem; margin-right: 40px; }
        nav { margin-left: auto; }
        nav a {
            color: #fff; text-decoration: none; margin: 0 15px; font-weight: bold; font-size: 1.1em;
            transition: color 0.12s;
        }
        nav a:hover { color: #ffdc52; }
        .profile-container {
            background: #fff; max-width: 550px; margin: 48px auto; padding: 36px 28px 40px 28px;
            border-radius: 14px; box-shadow: 0 16px 48px rgba(0,0,0,0.13);
        }
        .profile-header { font-size: 2.2em; color: #0074cc; font-family: 'Orbitron'; margin-bottom: 10px;}
        .field-group { display: flex; align-items: center; margin: 18px 0; }
        .field-label { width: 140px; font-weight: bold; color: #2d5bb5; }
        .field-value { font-size: 1.2em; background: #eef2f7; padding: 7px 16px; border-radius: 4px; min-width: 160px }
        .quick-actions { margin-top: 30px; text-align: center; }
        .quick-actions button, .quick-actions a {
            background: #0074cc; color: #fff; border: none; border-radius: 5px; font-size: 1em;
            padding: 10px 28px; cursor: pointer; font-weight: bold; margin: 0 12px; text-decoration: none;
            box-shadow: 0 4px 14px rgba(0,0,0,0.09);
            transition: background 0.16s;
        }
        .quick-actions button:hover, .quick-actions a:hover { background: #005fa3; }
        #logout-message { margin-top: 12px; color: #27ae60; font-size: 1.1em; }
        #error-message { margin-top: 14px; color: #e74c3c; font-weight: bold; }
        @media (max-width: 600px){
            .profile-container { padding:18px 5vw; }
            header { flex-direction: column; align-items: start; padding: 12px 10px;}
        }
    </style>
    <script src="https://npmcdn.com/parse/dist/parse.min.js"></script>
    <script src="parse-config.js"></script>
</head>
<body>
    <header>
        <img src="logo.png" class="logo" alt="JohnBlox Logo" onclick="window.location.href='index.html';">
        <div class="site-title">JohnBlox</div>
        <nav>
            <a href="index.html">Home</a>
            <a href="games.html">Games</a>
            <a href="shop.html">Shop</a>
            <a href="profile.html">Profile</a>
            <a href="settings.html">Settings</a>
        </nav>
    </header>
    <div class="profile-container" id="profile-view">
        <div class="profile-header">Profile</div>
        <div id="error-message"></div>
        <div class="field-group"><div class="field-label">Username:</div><div class="field-value" id="pf-username">Loading...</div></div>
        <div class="field-group"><div class="field-label">Email:</div><div class="field-value" id="pf-email"></div></div>
        <div class="field-group"><div class="field-label">Birthday:</div><div class="field-value" id="pf-birthday"></div></div>
        <div class="field-group"><div class="field-label">JohnBux:</div><div class="field-value" id="pf-johnbux"></div></div>
        <div class="field-group"><div class="field-label">Jix:</div><div class="field-value" id="pf-jix"></div></div>
        <div class="quick-actions">
            <a href="settings.html">Edit Profile / Settings</a>
            <button onclick="logoutAndGoHome()">Logout</button>
            <div id="logout-message"></div>
        </div>
    </div>
    <script>
      async function loadProfile() {
        const user = Parse.User.current();
        if (!user) {
          document.getElementById('profile-view').innerHTML = '<div style="color:red">Not logged in! <a href="login.html">Login here</a></div>';
          return;
        }
        document.getElementById('pf-username').textContent = user.getUsername();
        document.getElementById('pf-email').textContent = user.getEmail() || '—';
        document.getElementById('pf-birthday').textContent = user.get('birthday') || '—';
        document.getElementById('pf-johnbux').textContent = user.get('johnbux') || 0;
        document.getElementById('pf-jix').textContent = user.get('jix') || 0;
      }
      async function logoutAndGoHome() {
        try {
          await Parse.User.logOut();
          document.getElementById('logout-message').textContent = "Logged out!";
          setTimeout(() => window.location.href="index.html", 800);
        } catch {
          document.getElementById('logout-message').textContent = "Logout failed.";
        }
      }
      loadProfile();
    </script>
</body>
</html>
